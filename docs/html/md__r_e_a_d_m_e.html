<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.13.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>My Project: Principal Predictive Components for Estimating an Autoregressive Operator</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="clipboard.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="cookie.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
  $(function() { init_search(); });
/* @license-end */
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">My Project
   </div>
  </td>
    <td>        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <span id="MSearchSelect"                onmouseover="return searchBox.OnSearchSelectShow()"                onmouseout="return searchBox.OnSearchSelectHide()">&#160;</span>
          <input type="text" id="MSearchField" value="" placeholder="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.svg" alt=""/></a>
          </span>
        </div>
</td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.13.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() { codefold.init(0); });
/* @license-end */
</script>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function(){initNavTree('md__r_e_a_d_m_e.html',''); initResizable(true); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div><div class="header">
  <div class="headertitle"><div class="title">Principal Predictive Components for Estimating an Autoregressive Operator</div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p><a class="anchor" id="autotoc_md0"></a></p>
<p><b><code>PPCKO</code></b> is a C++ based R package for estimating an autoregressive operator, in the scenario of Functional Time Series (FTS). It relies on Principal Predictive Components (PPCs) <a class="el" href="#ref-PPCKO">Kargin-Onatski algorithm</a> to compute one-step ahead prediction of time series of curves and surfaces. The package provides functions to compute the forecasting, retaining the PPCs, to test the pointwise stationarity of the FTS and to visualize the results.</p>
<p>Assuming data coming from a stationary Functional AutoRegressive of order 1 process (<em>FAR(1)</em>)</p>
<p>$f_{n+1} = \rho f_n + \epsilon_{n+1}$</p>
<p>the predictor is shaped as</p>
<p>$\hat{f}_{n+1} = \sum _{i=1}^{k} \langle f_n, b_i \rangle a_i$</p>
<p>where:</p><ul>
<li>k is the number of retained PPCs;</li>
<li>$f_n$ is the curve/surface at the last available instant;</li>
<li>$a_i$ are the directions along which the prediction is approximated (directions that have the most predictive power) (predictive loadings);</li>
<li>$b_i$ weights the prediction along the $i$-th PPC: $\langle f_n, b_i \rangle$ is the projection along it (predictive factors).</li>
</ul>
<blockquote class="doxtable">
<p>&zwj;❗️ <b>N.B.:</b> The repository contains only the development of the algorithm through C++ its interface on R using RcppEigen and documentation. More detailed analysis about statistical properties of the predictor and implementation performances can be found <a href="https://github.com/AndreaEnricoFranzoni/Functional_time_series_forecasting">here</a>. </p>
</blockquote>
<h1><a class="anchor" id="autotoc_md1"></a>
Prerequisites</h1>
<p>R has to be updated at least to 4.0.0 version. If Windows is used, R version has to be at least 4.4.0.</p>
<p>On R console: </p><div class="fragment"><div class="line">library(devtools)</div>
</div><!-- fragment --><p>Or, alternatively, if not installed: </p><div class="fragment"><div class="line">install.packages(&quot;devtools&quot;)</div>
<div class="line">library(devtools)</div>
</div><!-- fragment --><p><b><code>PPCKO</code></b> depends also on having Fortran, Lapack, BLAS and, if parallel version is used, OpenMP installed. Depending on the operative system, the instructions to set up everything can be found here below.</p>
<h1><a class="anchor" id="autotoc_md2"></a>
Installation</h1>
<p>To install the package:</p>
<ul>
<li>Parallel version (highly recommended) <div class="fragment"><div class="line">devtools::install_github(&quot;AndreaEnricoFranzoni/PPCforAutoregressiveOperator&quot;)</div>
</div><!-- fragment --></li>
<li>Serial version (not available at the moment) <div class="fragment"><div class="line">devtools::install_github(&quot;AndreaEnricoFranzoni/PPCforAutoregressiveOperator@v2.0.0.no_omp&quot;) </div>
</div><!-- fragment --></li>
</ul>
<p>And upload the library in the R environment </p><div class="fragment"><div class="line">library(PPCKO)</div>
</div><!-- fragment --><p>Due to the high number of warnings, can be useful adding as argument of <code>install_github</code> </p><div class="fragment"><div class="line">quiet=TRUE</div>
</div><!-- fragment --><p> to disable them</p>
<p>If problem arises when installing, due to problems in the dependencies, also the argument </p><div class="fragment"><div class="line">dependencies = TRUE</div>
</div><!-- fragment --><p> could be useful</p>
<h1><a class="anchor" id="autotoc_md3"></a>
Documentation</h1>
<div class="fragment"><div class="line">?PPCKO</div>
</div><!-- fragment --><p> opens up the documentation of R-interfaced functions, if digited on the R console.</p>
<p>The documentation of all <b><code>PPCKO</code></b> C++ internal code can be found <a href="https://andreaenricofranzoni.github.io/PPCforAutoregressiveOperator/">here</a>.</p>
<h2><a class="anchor" id="autotoc_md4"></a>
Tutorials</h2>
<div class="fragment"><div class="line">?PPCKO</div>
</div><!-- fragment --><p> opens up the <b><code>PPCKO</code></b> documentation. In the section <code>Examples</code>, there is one tutorial for unidimensional case and one for bidimensional case. Although they do not run directly from here, can be easily reproduced locally.</p>
<h2><a class="anchor" id="autotoc_md5"></a>
Test</h2>
<p>To automatically test the package installation: </p><div class="fragment"><div class="line">devtools::test()</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md6"></a>
Data</h2>
<p>A time series of functions (synthetic data) can be loaded on the global environment using </p><div class="fragment"><div class="line">data(data_1d)</div>
</div><!-- fragment --><p>A time series of surfaces (synthetic data) can be loaded on the global environment using </p><div class="fragment"><div class="line">data(data_2d)</div>
</div><!-- fragment --><h1><a class="anchor" id="autotoc_md7"></a>
Prerequisites: depending on operative system</h1>
<p>More detailed documentation can be found in <a href="https://cran.r-project.org">this section</a> of <code>The R Manuals</code>. Although installing <b><code>PPCKO</code></b> should automatically install all the R dependecies, could be worth trying to install them manaully if an error occurs. </p><div class="fragment"><div class="line">install.packages(&quot;Rcpp&quot;)</div>
<div class="line">install.packages(&quot;RcppEigen&quot;)</div>
<div class="line">library(Rcpp)</div>
<div class="line">library(RcppEigen)</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md8"></a>
macOS</h2>
<ol type="1">
<li><b>Fortran</b>: unlike Linux and Windows, Fortran has to be installed on macOS: instructions in this <a href="https://cran.r-project.org/bin/macosx/tools/">link</a>. Lapack and BLAS will be consequently installed.</li>
<li><b>OpenMP</b>: unlike Linux and Windows, OMP is not installed by default on macOS. Open the terminal and digit the following commands.</li>
</ol>
<ul>
<li><b>Homebrew</b><ul>
<li>Check the presence of Homebrew <div class="fragment"><div class="line">brew --version</div>
</div><!-- fragment --><ul>
<li>If this command does not give back the version of Homebrew, install it according to the macOS version <div class="fragment"><div class="line">/bin/bash -c &quot;$(curl -fsSL https://raw.githubusercontent.com/Homebrew/install/HEAD/install.sh)&quot;</div>
</div><!-- fragment --><ol type="1">
<li><em>M1</em> or <em>M2</em> <div class="fragment"><div class="line">echo &#39;eval &quot;$(/opt/homebrew/bin/brew shellenv)&quot;&#39; &gt;&gt; ~/.zprofile</div>
<div class="line">eval &quot;$(/opt/homebrew/bin/brew shellenv)&quot;</div>
</div><!-- fragment --></li>
<li><em>Intel</em> <div class="fragment"><div class="line">echo &#39;eval &quot;$(/usr/local/bin/brew shellenv)&quot;&#39; &gt;&gt; ~/.zprofile</div>
<div class="line">eval &quot;$(/usr/local/bin/brew shellenv)&quot;</div>
</div><!-- fragment --></li>
</ol>
</li>
</ul>
</li>
</ul>
</li>
<li><b>OMP</b><ul>
<li>Once Homebrew is set, check the presence of OMP <div class="fragment"><div class="line">brew list libomp</div>
</div><!-- fragment --></li>
<li>Install it in case of negative output <div class="fragment"><div class="line">brew install libomp</div>
</div><!-- fragment --></li>
</ul>
</li>
<li><p class="startli"><b>LLVM</b></p>
<p class="startli"><a href="https://llvm.org">LLVM</a> is needed to configure clang on macOS in order to use an external OMP version</p><ul>
<li>Check its presence <div class="fragment"><div class="line">llvm-config --version</div>
</div><!-- fragment --></li>
<li>Eventually, download it <div class="fragment"><div class="line">brew install llvm</div>
</div><!-- fragment --></li>
</ul>
</li>
<li>Check that the command that opens the graphic window used by the visualization results functions <div class="fragment"><div class="line">quartz()</div>
</div><!-- fragment --> works on R, by digiting it on R console. If not, look <a href="https://www.xquartz.org">here</a>.</li>
</ul>
<h2><a class="anchor" id="autotoc_md9"></a>
Windows</h2>
<ul>
<li><b>Rtools</b>: can be installed from <a href="https://cran.r-project.org/bin/windows/Rtools/">here</a>. Version 4.4 is needed to install parallel version.</li>
<li>Check that the command that opens the graphic window used by the visualization results functions <div class="fragment"><div class="line">windows()</div>
</div><!-- fragment --> works on R, by digiting it on R console.</li>
</ul>
<h2><a class="anchor" id="autotoc_md10"></a>
Linux</h2>
<ul>
<li><p class="startli">Linux installation depends on its distributor. All the commands here reported will refer to Ubuntu and Debian distributors. Standard developement packages have to be installed. In Ubuntu and Debian, for example, all the packages have been collected into a single one, that is possible to install digiting into the terminal:</p>
<div class="fragment"><div class="line">sudo apt install r-base-dev</div>
<div class="line">sudo apt install build-essential</div>
</div><!-- fragment --></li>
<li>Check that the command that opens the graphic window used by the visualization results functions <div class="fragment"><div class="line">x11()</div>
</div><!-- fragment --> works on R, by digiting it on R console.</li>
</ul>
<h2><a class="anchor" id="autotoc_md11"></a>
Linux image</h2>
<p>Before being able to run the commands explained above for Linux, R has to be downloaded. Afterward, the installation of Fortran, Lapack, BLAS, devtools and its dependecies can be done by digiting into the terminal: </p><div class="fragment"><div class="line">sudo apt-get update</div>
<div class="line">sudo apt install gfortran</div>
<div class="line">sudo apt install liblapack-dev libblas-dev</div>
</div><!-- fragment --> <div class="fragment"><div class="line">sudo apt-get install libcurl4-openssl-dev</div>
<div class="line">sudo apt-get install libssl-dev</div>
<div class="line">sudo apt-get install libz-dev</div>
<div class="line">sudo apt-get install -y libcurl4-openssl-dev libssl-dev libxml2-dev</div>
<div class="line">sudo apt install zlib1g-dev</div>
<div class="line">sudo apt install -y libfreetype6-dev libfontconfig1-dev libharfbuzz-dev libcairo2-dev libpango1.0-dev pandoc</div>
</div><!-- fragment --><h1><a class="anchor" id="autotoc_md12"></a>
Bibliography</h1>
<ol type="1">
<li><a class="anchor" id="ref-PPCKO"></a></li>
</ol>
<p><b>Kargin, V., Onatski, A.</b>, <code>Curve forecasting by functional autoregression</code>, <em>Journal of Multivariate Analysis</em>, 99, 2508-2526, 2008, <a href="https://www.sciencedirect.com/science/article/pii/S0047259X08000961">https://www.sciencedirect.com/science/article/pii/S0047259X08000961</a></p>
<ol type="1">
<li><a class="anchor" id="ref-Rcpp"></a></li>
</ol>
<p><b>Eddelbuettel D., Francois R., Allaire J., Ushey K., Kou Q., Russell N., Ucar I., Bates D., Chambers J.</b>, <code>Rcpp: Seamless R and C++ Integration</code>, <em>R package version 1.0.13-1</em>, 2024, <a href="https://cran.r-project.org/web/packages/Rcpp/citation.html">https://cran.r-project.org/web/packages/Rcpp/citation.html</a></p>
<ol type="1">
<li><a class="anchor" id="ref-eigen"></a></li>
</ol>
<p><b>Guennebaud G., Jacob B., et Al.</b>, <code>Eigen v3.4</code>, 2021, <a href="https://eigen.tuxfamily.org/index.php?title=Main_Page">https://eigen.tuxfamily.org/index.php?title=Main_Page</a></p>
<ol type="1">
<li><a class="anchor" id="ref-spectra"></a></li>
</ol>
<p><b>Qui X., et Al.</b>, <code>Spectra - C++ Library For Large Scale Eigenvalue Problems</code>, 2022, <a href="https://spectralib.org">https://spectralib.org</a></p>
<ol type="1">
<li><a class="anchor" id="ref-mlpack"></a></li>
</ol>
<p><b>Curtin R. R., Edel M., Shrit O., Agrawal S., Basak S., Balamuta J. J., Birmingham R., Dutt K., Eddelbuettel D., Garg R., Jaiswal S., Kaushik A., Kim S., Mukherjee A., Gnana Sai N., Sharma N., Singh Parihar Y., Swain R., Sanderson C.</b>, <code>mlpack 4: a fast, header-only C++ machine learning library</code>, <em>Journal of Open Source Software</em>, 8, 82, 5026, 2023, <a href="https://www.mlpack.org">https://www.mlpack.org</a></p>
<ol type="1">
<li><a class="anchor" id="ref-armadillo"></a></li>
</ol>
<p><b>Sanderson C., Curtin R. R.</b>,  <code>Armadillo: a template-based C++ library for linear algebra</code>, <em>Journal of Open Source Software</em>, 1, 2, 26, 2016, <a href="https://arma.sourceforge.net">https://arma.sourceforge.net</a></p>
<ol type="1">
<li><a class="anchor" id="ref-armadillo2"></a></li>
</ol>
<p><b>Sanderson C., Curtin R. R.</b>,  <code>Practical Sparse Matrices in C++ with Hybrid Storage and Template-Based Expression Optimisation </code>, <em>Mathematical and Computational Applications</em>, 24, 3, 2019, <a href="https://arxiv.org/abs/1811.08768">https://arxiv.org/abs/1811.08768</a></p>
<ol type="1">
<li><a class="anchor" id="ref-ensmallen"></a></li>
</ol>
<p><b>Curtin R. R., Edel M., Ganesh Prabhu R., Basak S., Lou Z., Sanderson C.</b>, <code>The ensmallen library for flexible numerical optimization</code>, <em>Journal of Machine Learning Research</em>, 22, 166, 2021, <a href="https://ensmallen.org">https://ensmallen.org</a></p>
<ol type="1">
<li><a class="anchor" id="ref-cereal"></a></li>
</ol>
<p><b>Huebner L., et Al.</b>, <code>cereal - A C++11 library for serialization</code>, 2022, <a href="https://github.com/USCiLab/cereal">https://github.com/USCiLab/cereal</a></p>
<ol type="1">
<li><a class="anchor" id="ref-pacsexamples"></a></li>
</ol>
<p><b>Formaggia L., et Al.</b>, <code>EXAMPLES AND EXERCISES FOR AMSC and APSC (PACS) COURSES</code>, 2024, <a href="https://github.com/pacs-course/pacs-examples">https://github.com/pacs-course/pacs-examples</a></p>
<ol type="1">
<li><a class="anchor" id="ref-tseries"></a></li>
</ol>
<p><b>Trapletti A., Hornik K., LeBaron B.</b>, <code>tseries: Time Series Analysis and Computational Finance</code>, <em>CRAN repository</em>, 2024, <a href="https://cran.r-project.org/web/packages/tseries/index.html">https://cran.r-project.org/web/packages/tseries/index.html</a> </p>
</div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.13.1 </li>
  </ul>
</div>
</body>
</html>
